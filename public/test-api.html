<!DOCTYPE html>
<html>
<head>
    <title>Pokemon API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 15px 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            white-space: pre-wrap;
            background: #f5f5f5;
        }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Pokemon TCG API Test</h1>
    <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯• Pokemon TCG API æ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p>

    <button onclick="testAPI()">ğŸ” æµ‹è¯• API</button>
    <button onclick="testWithRetry()">ğŸ”„ æµ‹è¯• API (å¸¦é‡è¯•)</button>
    <button onclick="clearResult()">ğŸ—‘ï¸ æ¸…é™¤ç»“æœ</button>

    <div id="result"></div>

    <script>
        const API_KEY = 'f067131d-e09f-483e-97c8-5c34c7d33a3b';
        const resultDiv = document.getElementById('result');

        async function testAPI() {
            resultDiv.innerHTML = 'â³ æ­£åœ¨æµ‹è¯• API...';

            try {
                const startTime = Date.now();
                const response = await fetch('https://api.pokemontcg.io/v2/cards?page=1&pageSize=5', {
                    headers: {
                        'X-Api-Key': API_KEY
                    },
                    signal: AbortSignal.timeout(90000) // 90 seconds
                });

                const endTime = Date.now();
                const duration = ((endTime - startTime) / 1000).toFixed(2);

                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `<span class="success">âœ… æˆåŠŸ!</span>\n\n` +
                        `å“åº”æ—¶é—´: ${duration}s\n` +
                        `çŠ¶æ€ç : ${response.status}\n` +
                        `æ‰¾åˆ°å¡ç‰‡æ•°: ${data.data.length}\n` +
                        `æ€»æ•°: ${data.totalCount}\n\n` +
                        `ç¬¬ä¸€å¼ å¡ç‰‡: ${data.data[0].name}`;
                } else {
                    resultDiv.innerHTML = `<span class="error">âŒ é”™è¯¯!</span>\n\n` +
                        `å“åº”æ—¶é—´: ${duration}s\n` +
                        `çŠ¶æ€ç : ${response.status}\n` +
                        `é”™è¯¯: ${response.statusText}`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ è¯·æ±‚å¤±è´¥!</span>\n\n` +
                    `é”™è¯¯: ${error.message}`;
            }
        }

        async function testWithRetry() {
            resultDiv.innerHTML = 'â³ æ­£åœ¨æµ‹è¯• API (æœ€å¤šé‡è¯• 3 æ¬¡)...\n';

            for (let i = 1; i <= 3; i++) {
                resultDiv.innerHTML += `\nğŸ” å°è¯• ${i}/3...`;

                try {
                    const startTime = Date.now();
                    const response = await fetch('https://api.pokemontcg.io/v2/cards?page=1&pageSize=5', {
                        headers: {
                            'X-Api-Key': API_KEY
                        },
                        signal: AbortSignal.timeout(90000) // 90 seconds
                    });

                    const endTime = Date.now();
                    const duration = ((endTime - startTime) / 1000).toFixed(2);

                    if (response.ok) {
                        const data = await response.json();
                        resultDiv.innerHTML += `\n<span class="success">âœ… æˆåŠŸ!</span>\n\n` +
                            `å“åº”æ—¶é—´: ${duration}s\n` +
                            `çŠ¶æ€ç : ${response.status}\n` +
                            `æ‰¾åˆ°å¡ç‰‡æ•°: ${data.data.length}\n\n` +
                            `ç¬¬ä¸€å¼ å¡ç‰‡: ${data.data[0].name}`;
                        return;
                    } else {
                        resultDiv.innerHTML += ` å¤±è´¥ (${response.status})`;
                        if (i < 3) {
                            await new Promise(resolve => setTimeout(resolve, 2000));
                        }
                    }
                } catch (error) {
                    resultDiv.innerHTML += ` å¤±è´¥ (${error.message})`;
                    if (i < 3) {
                        await new Promise(resolve => setTimeout(resolve, 2000));
                    }
                }
            }

            resultDiv.innerHTML += `\n\n<span class="error">âŒ æ‰€æœ‰å°è¯•éƒ½å¤±è´¥äº†</span>`;
        }

        function clearResult() {
            resultDiv.innerHTML = '';
        }
    </script>
</body>
</html>
